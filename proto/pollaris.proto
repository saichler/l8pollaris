syntax = "proto3";

package l8tpollaris;

option java_multiple_files = true;
option java_outer_classname = "L8TPollaris";
option java_package = "com.l8tpollaris.types";
option go_package = "./types/l8tpollaris";

message L8Pollaris {
  string name = 1;
  string vendor = 2;
  string series = 3;
  string family = 4;
  string software = 5;
  string hardware = 6;
  string version = 7;
  repeated string groups = 8;
  map<string, L8Poll> polling = 9;
}

message L8Poll {
  string name = 1;
  string what = 2;
  L8C_Operation operation = 3;
  L8PProtocol  protocol = 4;
  L8PCadencePlan cadence = 5;
  int64 timeout = 6;
  repeated L8PAttribute attributes = 7;
  string bodyName = 8;
  string respName = 9;
  bool always = 10;
}

enum L8C_Operation {
  Invalid_Operation = 0;
  L8C_Get = 1;
  L8C_Map = 2;
  L8C_Table = 3;
}

enum L8PProtocol {
  L8PInvalid_Protocol = 0;
  L8PSSH = 1;
  L8PPSNMPV2 = 2;
  L8PSNMPV3 = 3;
  L8PRESTCONF = 4;
  L8PNETCONF = 5;
  L8PGRPC = 6;
  L8PKubectl = 7;
  L8PGraphQL = 8;
}

message L8PAttribute {
  string property_id = 1;
  repeated L8PRule rules = 2;
}

message L8PRule {
  string name = 1;
  map<string, L8PParameter> params = 2;
}

message L8PParameter {
  string name = 1;
  string value = 2;
}

message L8PCadencePlan {
  repeated int64 cadences = 1;
  repeated int64 startups = 2;
  int32 current = 3;
  bool enabled = 4;
}