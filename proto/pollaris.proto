// Â© 2025 Sharon Aicler (saichler@gmail.com)
//
// Layer 8 Ecosystem is licensed under the Apache License, Version 2.0.
// You may obtain a copy of the License at:
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// pollaris.proto defines the core polling configuration types for the Layer 8 ecosystem.
// These types specify how data should be collected from various targets using
// different protocols (SNMP, SSH, RESTCONF, NETCONF, gRPC, Kubernetes, GraphQL).

syntax = "proto3";

package l8tpollaris;

option java_multiple_files = true;
option java_outer_classname = "L8TPollaris";
option java_package = "com.l8tpollaris.types";
option go_package = "./types/l8tpollaris";

// L8Pollaris represents a polling configuration for a specific device type.
// It contains device classification attributes (vendor, series, family, etc.)
// and a map of named polling jobs that define what data to collect.
message L8Pollaris {
  // name is the unique identifier for this polling configuration
  string name = 1;
  // vendor specifies the device manufacturer (e.g., "cisco", "juniper")
  string vendor = 2;
  // series identifies the product series (e.g., "catalyst", "nexus")
  string series = 3;
  // family identifies the product family within the series
  string family = 4;
  // software specifies the software/OS type (e.g., "ios-xe", "junos")
  string software = 5;
  // hardware specifies the hardware model
  string hardware = 6;
  // version specifies the software version
  string version = 7;
  // groups lists the group names this configuration belongs to
  repeated string groups = 8;
  // polling maps job names to their polling configurations
  map<string, L8Poll> polling = 9;
}

// L8Poll defines a single polling job configuration.
// It specifies what data to collect, how to collect it, and how often.
message L8Poll {
  // name is the identifier for this polling job
  string name = 1;
  // what specifies the data to collect (e.g., OID for SNMP, command for SSH)
  string what = 2;
  // operation defines the type of collection (Get, Map, Table)
  L8C_Operation operation = 3;
  // protocol specifies which protocol to use for collection
  L8PProtocol  protocol = 4;
  // cadence defines the polling schedule
  L8PCadencePlan cadence = 5;
  // timeout is the maximum wait time in milliseconds
  int64 timeout = 6;
  // attributes define parsing rules for the collected data
  repeated L8PAttribute attributes = 7;
  // bodyName specifies the request body template name
  string bodyName = 8;
  // respName specifies the response parser name
  string respName = 9;
  // always indicates if this job should run on every collection cycle
  bool always = 10;
}

// L8C_Operation defines the type of data collection operation.
enum L8C_Operation {
  // Invalid_Operation is the default/unset value
  Invalid_Operation = 0;
  // L8C_Get retrieves a single value
  L8C_Get = 1;
  // L8C_Map retrieves key-value pairs
  L8C_Map = 2;
  // L8C_Table retrieves tabular data
  L8C_Table = 3;
}

// L8PProtocol defines the supported collection protocols.
enum L8PProtocol {
  // L8PInvalid_Protocol is the default/unset value
  L8PInvalid_Protocol = 0;
  // L8PSSH uses SSH for command-line polling
  L8PSSH = 1;
  // L8PPSNMPV2 uses SNMP version 2c
  L8PPSNMPV2 = 2;
  // L8PSNMPV3 uses SNMP version 3 with authentication
  L8PSNMPV3 = 3;
  // L8PRESTCONF uses REST-based configuration protocol
  L8PRESTCONF = 4;
  // L8PNETCONF uses Network Configuration Protocol
  L8PNETCONF = 5;
  // L8PGRPC uses gRPC for high-performance polling
  L8PGRPC = 6;
  // L8PKubectl uses kubectl for Kubernetes cluster polling
  L8PKubectl = 7;
  // L8PGraphQL uses GraphQL for flexible API queries
  L8PGraphQL = 8;
}

// L8PAttribute defines a parsed attribute from collected data.
message L8PAttribute {
  // property_id identifies the property this attribute maps to
  string property_id = 1;
  // rules define parsing/transformation rules for this attribute
  repeated L8PRule rules = 2;
}

// L8PRule defines a parsing or transformation rule.
message L8PRule {
  // name identifies the rule type
  string name = 1;
  // params contains rule-specific parameters
  map<string, L8PParameter> params = 2;
}

// L8PParameter represents a named parameter with a string value.
message L8PParameter {
  // name is the parameter identifier
  string name = 1;
  // value is the parameter value
  string value = 2;
}

// L8PCadencePlan defines the polling schedule with adaptive cadences.
// It supports multiple cadence levels that can be used based on conditions.
message L8PCadencePlan {
  // cadences is a list of polling intervals in milliseconds
  repeated int64 cadences = 1;
  // startups defines initial delays before polling starts
  repeated int64 startups = 2;
  // current is the index of the currently active cadence
  int32 current = 3;
  // enabled indicates if this cadence plan is active
  bool enabled = 4;
}