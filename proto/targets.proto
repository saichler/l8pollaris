syntax = "proto3";

package l8poll;

option java_multiple_files = true;
option java_outer_classname = "L8Types";
option java_package = "com.l8targets.types";
option go_package = "./types/l8poll";

import "pollaris.proto";

message L8C_TargetList {
  repeated L8C_Target list = 1;
}

message L8C_Target {
  string target_id = 1;
  L8ServiceInfo collect_service = 2;
  L8ServiceInfo parsing_service = 3;
  L8ServiceInfo inventory_service = 4;
  map<string, L8C_Host> hosts = 5;
}

message L8ServiceInfo {
  string service_name = 1;
  int32  service_area = 2;
}

message L8C_Host {
  string target_id = 1;
  map<int32, L8T_Connection> configs = 3;
  map<string, string> polls = 4;
  map<string, string> groups = 5;
}

message L8T_Connection {
  L8C_Protocol protocol = 1;
  string addr = 2;
  int32 port = 3;
  string read_community = 4;
  string write_community = 5;
  string username = 6;
  string password = 7;
  repeated string prompt = 8;
  string terminal = 9;
  repeated string terminal_commands = 10;
  int64 timeout = 11;
  string KubeConfig = 12;
  string KukeContext = 13;
}

message CMap {
  map<string, bytes> data = 1;
}

message CTable {
  map<int32, string> columns = 1;
  map<int32, CRow> rows = 2;
}

message CRow {
  map<int32, bytes> data = 1;
}